import{H as w,r as _,o as C,b as n,f as r,v as y,j as s,M as V,N as l,L as g,O as u,J as U,F as $,q as N,e as i,V as T,T as I,X as M,S as E}from"./uGLhbxAz.js";import{u as S}from"./CncYjveM.js";import{r as D}from"./Bbk6pL7h.js";import{r as L}from"./1HAJYFd6.js";import{r as j}from"./CIDNGuzx.js";const B={class:"space-y-6"},F={class:"flex items-center space-x-4"},P={class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W={class:"flex justify-between items-center mb-4"},A={class:"space-y-4"},H={class:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4"},J=["onUpdate:modelValue"],O=["onUpdate:modelValue","placeholder"],X={class:"flex items-center"},z={class:"flex items-center"},G=["onUpdate:modelValue","onChange"],K=["onClick"],Q={key:0,class:"text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg"},R={class:"flex justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700"},Y=["disabled"],Z={key:0},ee={key:1},ne={__name:"create",setup(re){const o=w({name:"",how_we_met:"",notes:"",contacts:[]}),m=_(!1);let b=1;const p=()=>{const a={id:b++,type:"phone",value:"",is_primary:o.contacts.length===0};o.contacts.push(a),console.log("Added contact:",a,"Total contacts:",o.contacts.length)},f=a=>{const e=o.contacts[a].is_primary;o.contacts.splice(a,1),e&&o.contacts.length>0&&(o.contacts[0].is_primary=!0)},x=a=>{o.contacts[a].is_primary&&o.contacts.forEach((e,t)=>{t!==a&&(e.is_primary=!1)})},k=a=>({phone:"02-1234-5678",mobile:"0912-345-678",email:"example@email.com",line:"LINE ID",wechat:"WeChat ID",telegram:"Telegram ID",other:"其他聯繫資訊"})[a]||"請輸入聯繫資訊",{createClient:h}=S(),v=async()=>{var a;try{if(m.value=!0,!o.name.trim()){alert("請輸入業主稱呼");return}const e=await h(o);e.success?await E("/clients"):alert(((a=e.error)==null?void 0:a.message)||"儲存業主失敗")}catch(e){console.error("儲存業主失敗:",e),alert("儲存業主失敗，請稍後再試")}finally{m.value=!1}};return C(()=>{p()}),(a,e)=>(i(),n("div",B,[r("div",F,[r("button",{onClick:e[0]||(e[0]=t=>a.$router.back()),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[y(s(D),{class:"w-5 h-5"})]),e[5]||(e[5]=r("div",null,[r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"新增業主"),r("p",{class:"text-gray-600 dark:text-gray-300"},"建立新的業主資料")],-1))]),r("div",P,[r("form",{onSubmit:V(v,["prevent"]),class:"p-6 space-y-6"},[r("div",null,[e[8]||(e[8]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"基本資訊",-1)),r("div",q,[r("div",null,[e[6]||(e[6]=r("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[g(" 業主稱呼 "),r("span",{class:"text-red-500"},"*")],-1)),l(r("input",{id:"name","onUpdate:modelValue":e[1]||(e[1]=t=>s(o).name=t),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"請輸入業主稱呼"},null,512),[[u,s(o).name]])]),r("div",null,[e[7]||(e[7]=r("label",{for:"how_we_met",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 認識方式 ",-1)),l(r("input",{id:"how_we_met","onUpdate:modelValue":e[2]||(e[2]=t=>s(o).how_we_met=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"例如：朋友介紹、網路接洽..."},null,512),[[u,s(o).how_we_met]])])])]),r("div",null,[e[9]||(e[9]=r("label",{for:"notes",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 備註 ",-1)),l(r("textarea",{id:"notes","onUpdate:modelValue":e[3]||(e[3]=t=>s(o).notes=t),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"關於這個業主的其他資訊..."},null,512),[[u,s(o).notes]])]),r("div",null,[r("div",W,[e[11]||(e[11]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"聯繫方式",-1)),r("button",{type:"button",onClick:p,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-primary-900 dark:text-primary-200"},[y(s(L),{class:"w-4 h-4 mr-1"}),e[10]||(e[10]=g(" 新增聯繫方式 "))])]),r("div",A,[(i(!0),n($,null,N(s(o).contacts,(t,c)=>(i(),n("div",{key:(t==null?void 0:t.id)||`contact-${c}`,class:"flex items-end space-x-4 p-4 border border-gray-200 dark:border-gray-600 rounded-lg"},[r("div",H,[r("div",null,[e[13]||(e[13]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 聯繫方式類型 ",-1)),l(r("select",{"onUpdate:modelValue":d=>t.type=d,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},e[12]||(e[12]=[I('<option value="phone">電話</option><option value="mobile">手機</option><option value="email">Email</option><option value="line">LINE</option><option value="wechat">WeChat</option><option value="telegram">Telegram</option><option value="other">其他</option>',7)]),8,J),[[T,t.type]])]),r("div",null,[e[14]||(e[14]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 聯繫資訊 ",-1)),l(r("input",{"onUpdate:modelValue":d=>t.value=d,type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:k(t.type)},null,8,O),[[u,t.value]])]),r("div",X,[r("label",z,[l(r("input",{"onUpdate:modelValue":d=>t.is_primary=d,type:"checkbox",onChange:d=>x(c),class:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"},null,40,G),[[M,t.is_primary]]),e[15]||(e[15]=r("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"設為主要",-1))])])]),r("button",{type:"button",onClick:d=>f(c),class:"p-2 text-red-600 hover:text-red-900 dark:text-red-400"},[y(s(j),{class:"w-4 h-4"})],8,K)]))),128)),s(o).contacts.length===0?(i(),n("div",Q,[e[16]||(e[16]=r("p",{class:"text-gray-500 dark:text-gray-400"},"尚未新增任何聯繫方式",-1)),r("button",{type:"button",onClick:p,class:"mt-2 text-primary-600 hover:text-primary-500 dark:text-primary-400"}," 點擊新增第一個聯繫方式 ")])):U("",!0)])]),r("div",R,[r("button",{type:"button",onClick:e[4]||(e[4]=t=>a.$router.back()),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," 取消 "),r("button",{type:"submit",disabled:s(m),class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[s(m)?(i(),n("span",Z,"儲存中...")):(i(),n("span",ee,"儲存業主"))],8,Y)])],32)])]))}};export{ne as default};
