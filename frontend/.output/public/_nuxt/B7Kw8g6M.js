import{a4 as o,E as n,a5 as i,S as r,a6 as d}from"./uGLhbxAz.js";const u=o(async c=>{let t,a;const e=n();if([t,a]=i(()=>e.initializeAuth()),await t,a(),!e.isLoggedIn)return console.log("[Admin Middleware] User not authenticated, redirecting to login"),r("/auth/login");try{e.user||([t,a]=i(()=>e.fetchUser()),await t,a())}catch(s){return console.warn("[Admin Middleware] Token validation failed:",s.message),r("/auth/login")}if(!e.isAdmin)throw console.log("[Admin Middleware] User is not admin, access denied"),d({statusCode:403,statusMessage:"Access denied. Administrator privileges required."})});export{u as default};
